<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      h1 {
        font-family: Helvetica;
        text-align: center;
        font-size: 12em;
        font-weight: 300;
      }
      iframe {
        display: none;
      }
    </style>
  </head>
  <body>
    <input id="target_above" type="text" placeholder="alarm ved hÃ¸y temp"/>
    <input id="target_below" type="text" placeholder="alarm ved lav temp"/>
    <h1 id="temp"></h1>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script>
      $(document).ready(function() {
        var notified;
        var notify = function() {
          notified = true;
          $('body').append('<iframe src="//www.youtube.com/embed/FoX7vd30zq8?autoplay=1"></iframe>');
        };
        var fetchTemp = function() {
          $.ajax({
            url: "http://10.0.0.20:1337",
            success: function(d) {
              $('#temp').text(d);
              var target_above = parseInt($('#target_above').val(), 10);
              var target_below = parseInt($('#target_below').val(), 10);
              var val = parseInt(d, 10);
              if (val < target_below && !notified) {
                notify();
              }
              if (val > target_above && !notified) {
                notify();
              }
              setTimeout(fetchTemp, 2000);
            },
            error: function() {
              alert('Error. Reload please!');
            }
          });
        };
        fetchTemp();
      });
    </script>
  </body>
</html>
